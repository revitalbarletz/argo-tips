apiVersion: v1
kind: ConfigMap
metadata:
  name: ai-agent-scripts
  namespace: argo-tips
  annotations:
    argocd.argoproj.io/sync-wave: "4"   # run after post-sync
data:
  agent.py: |
    import requests

    url = "http://argo-tips.argo-tips.svc.cluster.local:80/"
    try:
        r = requests.get(url, timeout=3)
        if r.status_code == 200:
            print("🤖 AI Advisor: Deployment is healthy ✅")
        else:
            print(f"🤖 AI Advisor: Warning — Deployment returned status {r.status_code}")
    except Exception as e:
        print("🤖 AI Advisor: Deployment unreachable ❌", e)
